<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>银行卡充值</title>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
    <link href="css/chongzhi.css" rel="stylesheet" type="text/css">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="app" style="max-width: 700px;margin-left: auto;margin-right: auto;position: relative;overflow: auto">
<div class="ewm">
    <div class="bg">
        <ul class="row">
            <li class="col-xs-6">所属银行</li>
            <li id="ssxh" class="col-xs-6">&nbsp;</li>
            <li class="col-xs-6 ">账号</li>
            <li id="zh" class="col-xs-6 zh">&nbsp;</li>
            <li class="col-xs-6">姓名</li>
            <li id="xm" class="col-xs-6 xm">&nbsp;</li>
        </ul>
    </div>
    <div class="saomiao">
        <p>扫描以上二维码，转账充值。<br />付款后提交订单审核</p>
    </div>
</div>
<div>
    <ul class="hyzh">
        <li>会员账号&nbsp;:<input type="text" id="val_login"><hr /></li>
        <li>转账金额&nbsp;:<input type="text" id="val_balance"><hr /></li>
        <li>转账账号&nbsp;:<input type="text" id="val_no"><hr /></li>
    </ul>
    <div class="an">
        <input type="button" value="确定" onclick="chongzhi()" class="btn-info btn" style="width: 150px;height: 40px;
        font-size:20px ">
    </div>
</div>
</div>
<script src="js/jquery.min.js"></script>
<script src="js/main.js"></script>
<script>
    window.onload = function  wxzf(){
        $.ajax({
            url:'/api/payments/get_payments.json',
            type:'get',
            success:function (data) {
                data=data.data
                if(data.bank_status==true){
                    document.getElementById("ssxh").innerHTML = data.bank_name;
                    document.getElementById("zh").innerHTML = data.bank_no;
                    document.getElementById("xm").innerHTML = data.bank_user;
                }else{
                    alert('暂不支持转账支付');
                    history.go(-1)
                    return ;
                }
            }
        })
    }
    function chongzhi() {
        if ($('#val_balance').val() <= 0){
            alert('充值金额需大于0');
            return ;
        } else if ($('#val_balance').val() > 100000){
            alert('充值金额不能大于100000');
            return ;
        }
        if(isNaN($('#val_balance').val())){
            alert('请输入数字');
            return false;
        }

        if ($('#val_login').val().length == 0){
            alert('请输入会员账号');
            return ;
        }
        if ($('#val_no').val().length == 0){
            alert('请输入转账账号');
            return ;
        }
        $.ajax({
            url:'/api/payments/order.json',
            type:'post',
            data:{payments:{
                balance:$('#val_balance').val(),
                category:'银行充值',
                no:$('#val_no').val()
            }},
            success:function (data) {
                if(data.code==0){
                    alert('充值成功，请等待审核');
                    history.go(-1)
                }
            }
        })
    }
</script>
</body>
</html>