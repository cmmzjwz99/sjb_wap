<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>世界杯</title>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/cz.css" rel="stylesheet" type="text/css">
    <link href="css/jcls.css" rel="stylesheet" type="text/css">
    <style>

        .header {
            position: fixed;
            z-index: 60;
            width: 100%;
            max-width: 700px;
            height: 35px;
            top: 0;
            text-align: center;
            line-height: 35px;
            font-size: 17px;
            margin-right: auto;
            margin-left: auto;
            background-color: #2d59df;
            color: white;
        }

        .footer a {
            color: black;
        }

        .footer {
            position: fixed;
            z-index: 60;
            width: 100%;
            max-width: 700px;
            height: 50px;
            bottom: 0;
            background-color: white;
        }

        .footer .footer_item {
            float: left;
            width: 33.3333%
        }

        table {
            margin: 10px 2%;
        }
    </style>
</head>
<body>

<div class="app"
     style="background-color: #f2f2f2;max-width: 700px;margin-left: auto;margin-right: auto;position: relative;overflow: auto;padding-top: 35px">

    <div class="header">
        娱乐平台
    </div>
    <div class="top" style="max-width: 700px">
        <div class="zhxx">
            <div style="padding-top: 20%"><img src="imgs/210705163930538428.png"></div>
            <div style="padding-bottom: 20%" id="name_val"></div>
        </div>
        <div class="jinbi">
            <ul>
                <li style="font-size: 8px;">金币余额:</li>
                <li style="font-size: 25px;" id="points_val"></li>
                <li>
                    <button class="btn btn-sm  top-an">去充值</button>
                </li>
            </ul>
        </div>
    </div>
    <div class="ls" style="margin-bottom: 50px">

    </div>
    <div class="footer" style="height: 45px;text-align: center;font-size: 10px;">
        <a href="index.html" style="color: #8a8a8a">
            <div class="footer_item">
                <div><img src="imgs/竞猜2.png" style="width: 25px;margin-top: 3px"></div>
                <div>竞猜</div>
            </div>
        </a>
        <div class="footer_item">
            <div><img src="imgs/竞猜历史2.png" style="width: 25px;margin-top: 3px"></div>
            <div style="color: #2d59df">竞猜历史</div>
        </div>
        <a href="cz.html" style="color: #8a8a8a">
            <div class="footer_item">
                <div><img src="imgs/我的筹码1.png" style="width: 25px;margin-top: 3px"></div>
                <div>我的筹码</div>
            </div>
        </a>
    </div>
</div>
<script src="js/jquery.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/main.js"></script>
<script>
    data = [
        {
            "point": 200,
            "get_point": "进行中",
            "team": "意大利胜",
            "match": "B组小组赛 法国VS意大利",
            "game": "胜负",
            "time": "2018-05-12"
        },
        {
            "point": 200,
            "get_point": "240.0",
            "team": "法国胜",
            "match": "B组小组赛 法国VS意大利",
            "game": "法国-0.5",
            "time": "2018-05-13"
        },
        {
            "point": 200,
            "get_point": "240.0",
            "team": "法国胜",
            "match": "B组小组赛 法国VS意大利",
            "game": "法国-0.5",
            "time": "2018-05-13",

        }
    ]
    function render(data) {
        var date = '';
        for (var i = 0; i < data.length; i++) { //遍历一下json数据
            if (date != data[i].time) {
                var div = document.createElement("div");
                div.innerHTML = data[i].time;

                $(".ls")[0].appendChild(div)
                var xdb = document.createElement("table");
                var hp = document.createElement("td");
                var hp1 = document.createElement("td");
                var hp2 = document.createElement("td");
                xdb.appendChild(hp);
                xdb.appendChild(hp1);
                xdb.appendChild(hp2);


                var xd = document.createElement("tr");
                xd.style.backgroundColor = "#4870E3";
                xdb.appendChild(xd);
                xdb.id = data[i].time;

                var bs = document.createElement('td');
                bs.innerHTML = "比赛";
                xd.appendChild(bs);

                var pankou = document.createElement('td');
                pankou.innerHTML = "盘口";
                xd.appendChild(pankou);

                var jcjb = document.createElement('td');
                jcjb.innerHTML = "竞猜金币";
                xd.appendChild(jcjb);

                var sy = document.createElement('td');
                sy.innerHTML = "收益";
                xd.appendChild(sy);

                var ts = getDataRow(data[i]);
                xdb.appendChild(ts);
                $(".ls")[0].appendChild(xdb);
                date = data[i].time;
            } else {
                var ts = getDataRow(data[i]);
                var xdb = document.getElementById(data[i].time);
                xdb.appendChild(ts)
                $(".ls")[0].appendChild(xdb);
            }
        }
    }
    window.onload = function () {
        $.ajax({
            url: '/api/accounts/info.json',
            type: 'get',
            success: function (data) {
                data = data.data
                $('#points_val').html(data.points+'.00')
                $('#name_val').html(data.login)
                console.log(data)
            }
        })
        $.ajax({
            url: '/api/quiz/my_order.json',
            type: 'get',
            success: function (data) {
                data = data.data
                render(data)
            },
            error: function () {
                render(data)
            }
        })
    }

    function getDataRow(h) {
        var row = document.createElement('tr'); //创建行

        var idCell = document.createElement('td'); //创建第一列id
        idCell.innerHTML = h.match; //填充数据
        row.appendChild(idCell); //加入行  ，下面类似

        var nameCell = document.createElement('td');//创建第二列name
        nameCell.innerHTML = h.game;
        row.appendChild(nameCell);

        var jobCell = document.createElement('td');//创建第三列job
        jobCell.innerHTML = h.point;
        row.appendChild(jobCell);

        var disilie = document.createElement('td')
        disilie.innerHTML = h.get_point;
        row.appendChild(disilie)

        if (h.get_point == "进行中" || h.get_point == "结算中" ) {
            row.style.backgroundColor = "#669933";
        }else{
            row.style.backgroundColor = "#ffffff";
        }

        return row;
    }
</script>
</body>
</html>